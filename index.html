<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Insulina</title>

    <!-- Favicon -->
    <link rel="icon" href="favicon-512.ico" type="image/x-icon">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">

    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>üíâ Controle de Insulina</h1>
</header>

<main>

    <!-- REGISTRO -->
    <section class="card">
        <h2>Registrar Glicemia</h2>

        <input type="text"
               id="nomePaciente"
               placeholder="Nome do Paciente">

        <input type="number"
               id="glicemiaValor"
               placeholder="Valor (mg/dL)"
               min="1"
               step="1">

        <select id="periodoGlicemia">
            <option value="Manh√£">Manh√£</option>
            <option value="Tarde">Tarde</option>
            <option value="Noite">Noite</option>
        </select>

        <select id="tipoInsulina">
            <option value="R√°pida">R√°pida</option>
            <option value="Lenta">Lenta</option>
        </select>

        <input type="number"
               id="doseInsulina"
               placeholder="Unidades (opcional)"
               min="0"
               step="1">

        <button onclick="registrarGlicemia()">
            Salvar
        </button>
    </section>

    <!-- √öLTIMO REGISTRO -->
    <section class="card">
        <h2>√öltimo Registro</h2>
        <p id="ultimaGlicemia">Nenhum registro</p>
    </section>

    <!-- M√âDIA -->
    <section class="card">
        <h2>M√©dia de Hoje</h2>
        <p id="mediaHoje">Nenhum dado</p>
    </section>

    <!-- STATUS -->
    <section class="card" id="cardStatus">
        <h2>Status Atual</h2>
        <p id="statusGlicemia">---</p>
    </section>

    <!-- GR√ÅFICO -->
    <section class="card">
        <h2>Evolu√ß√£o de Hoje</h2>
        <canvas id="graficoGlicemia"></canvas>
    </section>

    <!-- HIST√ìRICO RESUMIDO -->
    <section class="card">
        <h2>Hist√≥rico</h2>
        <ul id="listaGlicemias"></ul>

        <button onclick="abrirModalHistorico()" class="btn-secundario">
            Ver hist√≥rico completo
        </button>
    </section>

    <!-- RESUMO -->
    <section class="card">
        <h2>Resumo do Dia</h2>
        <p id="resumoDia">Nenhum dado hoje.</p>
    </section>

    <!-- AVISO -->
    <section class="card aviso">
        ‚ö†Ô∏è Este aplicativo n√£o substitui orienta√ß√£o m√©dica.
    </section>

</main>

<!-- MODAL HIST√ìRICO -->
<div id="modalHistorico"
     class="modal"
     style="display:none;"
     onclick="fecharAoClicarFora(event)">

    <div class="modal-conteudo"
         onclick="event.stopPropagation()">

        <h2>Hist√≥rico Completo</h2>

        <input type="date"
               id="filtroData"
               onchange="filtrarHistorico()"
               class="input-filtro">

        <ul id="listaCompleta"></ul>

        <button onclick="exportarPDF()" class="btn-secundario">
            Exportar PDF
        </button>

        <button onclick="limparHistorico()" class="btn-perigo">
            Limpar Hist√≥rico
        </button>

        <button onclick="fecharModalHistorico()" class="btn-secundario">
            Fechar
        </button>

    </div>
</div>

<!-- MODAL CONFIRMA√á√ÉO -->
<div id="modalConfirmar"
     class="modal"
     style="display:none;">

    <div class="modal-conteudo alerta">

        <div class="icone-alerta">‚ö†</div>

        <h3>Aten√ß√£o</h3>
        <p>Para limpar todo o hist√≥rico, digite <strong>CONFIRMAR</strong> abaixo:</p>

        <input type="text"
               id="inputConfirmar"
               placeholder="Digite CONFIRMAR"
               oninput="verificarConfirmacao()">

        <div class="modal-botoes">

            <button class="btn-cancelar"
                    onclick="fecharModalConfirmar()">
                Cancelar
            </button>

            <button id="btnConfirmarLimpeza"
                    class="btn-confirmar"
                    onclick="confirmarLimpeza()"
                    disabled>
                Sim, limpar
            </button>

        </div>

    </div>
</div>

<!-- MODAL ALERTA -->
<div id="modalAlerta"
     class="modal"
     style="display:none;">

    <div class="modal-conteudo alerta">

        <div class="icone-alerta">‚ö†</div>

        <h3>Aten√ß√£o</h3>

        <p id="mensagemAlerta">Mensagem aqui</p>

        <button class="btn-confirmar"
                onclick="fecharModalAlerta()">
            OK
        </button>

    </div>
</div>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="app.js"></script>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker registrado com sucesso"))
        .catch(err => console.log("Erro SW:", err));
}
</script>

</body>
</html>
